{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/js/index.js","src/js/spy.js"],"names":[],"mappings":"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","file":"build.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import spy from './spy.js'\n\nvar s = spy();\nvar pos;\nvar preData;\nvar firebase = new Firebase(\"https://blog-new.firebaseio.com/\");\n// document.querySelector('#play').addEventListener('click', function(e) {\n//     var data = s.export();\n//     s.play(document.querySelector('#cursor'), data);\n// });\n// document.getElementById('test').addEventListener('click', function() {\n//     console.log('success');\n// })\n\n// set when to save\ndocument.addEventListener('keydown', function(e) {\n    console.log(e);\n})\nwindow.setInterval(saveToFirebase, 3000);\n\nfunction saveToFirebase() {\n    console.log(s.export());\n    var data = s.export();\n    if (preData && preData.length === data.length) {\n        return;\n    }\n    if (!data.length) {\n        return;\n    }\n    if (!pos) {\n        pos = firebase.push({data: data});\n    } else {\n        pos.set({data: data});\n    }\n    preData = data;\n}\n","var Spy = function() {\n  this.isRecording = false;\n  this.rAF = undefined;\n  this.intelligenceBox = [];\n  this.bindListeners();\n};\n\nSpy.prototype.start = function() {\n  this.isRecording = true;\n  this.rAF = window.requestAnimationFrame(this.moment.bind(this));\n  return this;\n};\n\nSpy.prototype.moment = function(ts) {\n  this.isRecording = true;\n\n  this.rAF = window.requestAnimationFrame(this.moment.bind(this));\n};\n\nSpy.prototype.bindListeners = function() {\n  window.addEventListener('mousemove', e => {\n    if (!this.isRecording)\n      return;\n    this.intelligenceBox.push(this.createIntel(e, 'mousemove'));\n  }, true);\n  window.addEventListener('click', e => {\n    console.log(e);\n    if (!this.isRecording)\n      return;\n    this.intelligenceBox.push(this.createIntel(e, 'click'));\n  }, true);\n  window.addEventListener('scroll', e => {\n    if (!this.isRecording)\n      return;\n    this.intelligenceBox.push(this.createIntel(e, 'scroll'));\n  }, true);\n  // window.addEventListener('beforeunload', e => {\n  //   this.saveToLocalStorage(this.export());\n  // });\n};\n\n// Spy.prototype.saveToLocalStorage = function(data) {\n//   var info = {\n//     page: location\n//     intelligences: data\n//   }\n//   localStorage.setItem('spy-data', data);\n// };\n\nSpy.prototype.createIntel = function(event, behavior) {\n  var intelligence = {\n    x: event.pageX || null,\n    y: event.pageY || null,\n    scrollX: window.scrollX,\n    scrollY: window.scrollY,\n    target: event.target.getAttribute? event.target.getAttribute('id') : null,\n    behavior: behavior,\n    ts: Date.now()\n  };\n  return intelligence;\n};\n\nSpy.prototype.export = function() {\n  return this.intelligenceBox;\n};\n\nSpy.prototype.play = function(cursor, box) {\n  let start = box[0].ts;\n  box.forEach(intelligence => {\n    setTimeout(() => {\n\n      if (intelligence.behavior === 'scroll') {\n        window.scroll(intelligence.scrollX, intelligence.scrollY);\n      } else if (intelligence.behavior === 'mousemove') {\n        cursor.style.left = intelligence.x + 'px';\n        cursor.style.top = intelligence.y + 'px';\n      } else if (intelligence.behavior === 'click') {\n        if (intelligence.target) {\n          var evObj = document.createEvent('Events');\n          evObj.initEvent('click', true, false);\n          document.getElementById(intelligence.target).dispatchEvent(evObj);\n        }\n      }\n    }, intelligence.ts - start);\n  })\n};\n\nexport default function() {\n  return new Spy().start();\n}\n"]}