{"version":3,"sources":["spy.js","play.js","analysis.js","index.js"],"names":[],"mappings":"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","file":"build.js","sourcesContent":["var isRecording = false\nvar frame = undefined\nvar box = []\n\n// TODO: debounce\nfunction bindListeners(context) {\n  context.addEventListener('mousemove', e => box.push(pkg(context, e, 'mousemove')), true)\n  context.addEventListener('click', e => box.push(pkg(context, e, 'click')), true)\n  context.addEventListener('scroll', e => box.push(pkg(context, e, 'scroll')), true)\n}\n\nfunction pkg(context, event, behavior) {\n  return {\n    x: event.pageX || null,\n    y: event.pageY || null,\n    offsetX: event.offsetX,\n    offsetY: event.offsetY,\n    scrollX: context.scrollX,\n    scrollY: context.scrollY,\n    target: event.target.getAttribute ? event.target.getAttribute('id') : null,\n    behavior: behavior,\n    ts: Date.now()\n  }\n}\n\nexport function data() {\n  return box\n}\n\nexport function tick(context) {\n  isRecording || bindListeners(context)\n  isRecording = true\n  frame = requestAnimationFrame(tick)\n}\n","// TODO: Need a lot of enhancement, like selector and sync layout and setTimeout\nexport function play(cursor, box) {\n  let start = box[0].ts;\n  box.forEach(pkg => {\n    setTimeout(() => {\n      if (pkg.behavior === 'scroll') {\n        window.scroll(pkg.scrollX, pkg.scrollY);\n      } else if (pkg.behavior === 'mousemove') {\n        if (pkg.target && document.getElementById(pkg.target)) {\n          cursor.style.left = document.getElementById(pkg.target).pageX + pkg.offsetX;\n          cursor.style.top = document.getElementById(pkg.target).pageY + pkg.offsetY;\n        } else {\n          cursor.style.left = pkg.x + 'px';\n          cursor.style.top = pkg.y + 'px';\n        }\n        cursor.style.left = pkg.x + 'px';\n        cursor.style.top = pkg.y + 'px';\n      } else if (pkg.behavior === 'click') {\n        if (pkg.target) {\n          var evObj = document.createEvent('Events');\n          evObj.initEvent('click', true, false);\n          document.getElementById(pkg.target).dispatchEvent(evObj);\n        }\n      }\n    }, pkg.ts - start);\n  })\n}\nfunction click() {}\nfunction scroll() {}\nfunction mousemove() {}\n","function mostClicked(data) {\n  return getMaxKey(allClicked(data))\n}\nfunction allClicked(data) {\n  return data\n    .filter(pkg => pkg.behavior === 'click')\n    .reduce((result, pkg) => {\n      if (!result[pkg.target])\n        result[pkg.target] = 0\n      ++result[pkg.target]\n      return result\n    }, {})\n}\nfunction getMaxKey(obj) {\n  var max = 0\n  var maxKey\n  Object.keys(obj).forEach(idx => {\n    if (max < obj[idx]) {\n      max = obj[idx]\n      maxKey = idx\n    }\n  })\n  return maxKey\n}\nexport {\n  mostClicked\n}\n","import { tick, data } from './spy.js';\nimport { play } from './play'\nimport { mostClicked } from './analysis.js'\nvar pos\nvar preData\ntick(window)\ndocument.querySelector('#play').addEventListener('click', function(e) {\n  var d = data()\n  play(document.querySelector('#cursor'), d)\n  console.log(mostClicked(d))\n})\ndocument.getElementById('test').addEventListener('click', function() {\n  console.log('success')\n})\n\n"],"sourceRoot":"/source/"}